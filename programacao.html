<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Programação de Cargas | Rio Branco</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#0A3D91;
  color:#fff;
  padding:20px;
}
.container{
  max-width:520px;
  margin:auto;
}
h2{
  text-align:center;
  margin-bottom:10px;
}
p.sub{
  text-align:center;
  font-size:13px;
  opacity:.8;
}

input, textarea, button{
  width:100%;
  padding:14px;
  font-size:16px;
  margin-top:10px;
  border:none;
  border-radius:6px;
}

textarea{
  resize:vertical;
}

button{
  background:#D71920;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}

button:disabled{
  opacity:.6;
  cursor:not-allowed;
}

.msg{
  margin-top:15px;
  text-align:center;
  font-weight:bold;
}

/* SPINNER */
.spinner{
  border:4px solid #f3f3f3;
  border-top:4px solid #D71920;
  border-radius:50%;
  width:26px;
  height:26px;
  animation:spin 1s linear infinite;
  margin:15px auto;
}
@keyframes spin{
  0%{transform:rotate(0deg)}
  100%{transform:rotate(360deg)}
}

footer{
  margin-top:30px;
  text-align:center;
  font-size:12px;
  opacity:0.8;
}
</style>
</head>

<body>

<div class="container">
  <h2>Programação de Cargas</h2>
  <p class="sub">Rio Branco Distribuidora de Combustíveis</p>

  <input id="data" type="date">
  <input id="hora" type="time">
  <input id="vendedor" placeholder="Vendedor">
  <input id="cliente" placeholder="Cliente">
  <input id="cidade" placeholder="Cidade">
  <input id="volume" type="number" step="0.01" placeholder="Volume">
  <textarea id="obs" placeholder="Observações"></textarea>
  <input id="senha" type="password" placeholder="Senha administrativa">

  <button id="btn" onclick="programar()">Programar Carga</button>

  <div class="msg" id="msg"></div>
  <div id="loading" style="display:none">
    <div class="spinner"></div>
  </div>
</div>

<footer>
  © <span id="ano"></span> · Copywriter Renato Monteiro
</footer>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyjSbo7fO2pmc8IjkGDarvFw0QRQs333uLt9oNVgji6fEPErcoeibiKmcLsXMTz_eGQ6w/exec";

const btn = document.getElementById("btn");
const msg = document.getElementById("msg");
const loading = document.getElementById("loading");

function setLoading(v){
  btn.disabled = v;
  loading.style.display = v ? "block" : "none";
}

function programar(){
  msg.textContent = "";

  const dados = {
    acao: "programar",
    senha: senha.value,
    data: data.value,
    hora: hora.value,
    vendedor: vendedor.value,
    cliente: cliente.value,
    cidade: cidade.value,
    volume: volume.value,
    obs: obs.value
  };

  // validação básica
  if(!dados.data || !dados.hora || !dados.vendedor || !dados.cliente || !dados.volume || !dados.senha){
    msg.textContent = "⚠️ Preencha todos os campos obrigatórios";
    return;
  }

  setLoading(true);

  fetch(SCRIPT_URL, {
    method: "POST",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: new URLSearchParams(dados)
  })
  .then(r => r.text())
  .then(ret => {
    msg.textContent = ret;
    setLoading(false);

    if(ret.startsWith("✅")){
      data.value="";
      hora.value="";
      vendedor.value="";
      cliente.value="";
      cidade.value="";
      volume.value="";
      obs.value="";
    }
  })
  .catch(err=>{
    msg.textContent = "❌ Erro de conexão";
    setLoading(false);
  });
}

document.getElementById("ano").textContent = new Date().getFullYear();
</script>

</body>
</html>
